/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package org.xpup.hafmis.sysloan.querystatistics.querystatistics.loandeskaccquery.action;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.actions.LookupDispatchAction;
import org.xpup.common.util.BSUtils;
import org.xpup.common.util.Pagination;
import org.xpup.hafmis.orgstrct.dto.SecurityInfo;
import org.xpup.hafmis.syscollection.systemmaintain.loanpara.bsinterface.ILoanDocNumDesignBS;
import org.xpup.hafmis.sysloan.querystatistics.querystatistics.loandeskaccquery.bsinterface.ILoandeskaccqueryBS;

/**
 * MyEclipse Struts Creation date: 10-19-2007 XDoclet definition:
 * 
 * @struts.action validate="true"
 */
public class LoanDeskaccQueryTaMaintainAC extends LookupDispatchAction {
  /*
   * Generated Methods
   */

  /**
   * Method execute
   * 
   * @param mapping
   * @param form
   * @param request
   * @param response
   * @return ActionForward
   */
  protected Map getKeyMethodMap() {
    Map map = new HashMap();
    map.put("button.individual.flow", "individualFlow");
    map.put("button.contract.info", "contractInfo");
    map.put("button.print", "print");
    return map;
  }

  public ActionForward individualFlow(ActionMapping mapping, ActionForm form,
      HttpServletRequest request, HttpServletResponse response) {
    // TODO Auto-generated method stub
    return null;
  }

  public ActionForward contractInfo(ActionMapping mapping, ActionForm form,
      HttpServletRequest request, HttpServletResponse response) {
    // TODO Auto-generated method stub
    return null;
  }

  public ActionForward print(ActionMapping mapping, ActionForm form,
      HttpServletRequest request, HttpServletResponse response) {
    try {
      SecurityInfo securityInfo = (SecurityInfo) request.getSession()
          .getAttribute("SecurityInfo");
      Pagination pagination = (Pagination) request.getSession().getAttribute(
          LoanDeskaccQueryTaShowAC.PAGINATION_KEY);
      String bank = "";
      if (pagination != null) {
        bank = (String) pagination.getQueryCriterions().get("paybank_");
      }
      ILoanDocNumDesignBS loanDocNumDesignBS = (ILoanDocNumDesignBS) BSUtils
          .getBusinessService("loanDocNumDesignBS", this, mapping
              .getModuleConfig());
      String userName = "";
      String name = loanDocNumDesignBS.getNamePara();

      if (name.equals("1")) {
        userName = securityInfo.getUserName();
      } else {
        userName = securityInfo.getRealName();
      }
      ILoandeskaccqueryBS loandeskaccqueryBS = (ILoandeskaccqueryBS) BSUtils
          .getBusinessService("loandeskaccqueryBS", this, mapping
              .getModuleConfig());
      List printList = loandeskaccqueryBS.showLoandeskaccAllList(pagination,
          securityInfo);
      request.setAttribute("cellList", printList);
      String time = securityInfo.getUserInfo().getPlbizDate();
      request.setAttribute("opertname", userName);
      request.setAttribute("time", time);
      request.setAttribute("paybank_", bank);
    } catch (Exception e) {
      e.printStackTrace();
    }

    return mapping.findForward("loandeskaccqueryta_cell");
  }
}