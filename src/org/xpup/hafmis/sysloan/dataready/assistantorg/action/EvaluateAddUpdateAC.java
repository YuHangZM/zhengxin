/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package org.xpup.hafmis.sysloan.dataready.assistantorg.action;
import java.util.HashMap;
import java.util.Map;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.beanutils.BeanUtils;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.action.ActionMessage;
import org.apache.struts.action.ActionMessages;
import org.apache.struts.actions.LookupDispatchAction;
import org.xpup.common.util.BSUtils;
import org.xpup.hafmis.orgstrct.dto.SecurityInfo;
import org.xpup.hafmis.sysloan.dataready.assistantorg.bsinterface.IEvaluateBS;
import org.xpup.hafmis.sysloan.dataready.assistantorg.dto.EvaluateAFDTO;
import org.xpup.hafmis.sysloan.dataready.assistantorg.form.EvaluateAF;


/** 
 * MyEclipse Struts
 * Creation date: 09-29-2007
 * 
 * XDoclet definition:
 * @struts.action validate="true"
 */
public class EvaluateAddUpdateAC extends LookupDispatchAction {
  public static final String PAGINATION_KEY =
    "org.xpup.hafmis.sysloan.dataready.assistantorg.action.EvaluateShowAC";
  protected Map getKeyMethodMap() {
    Map map = new HashMap();
    map.put("button.sure", "sure");
    map.put("button.scan", "scan");
    map.put("button.back", "back");
    return map;
  }
  
  public ActionForward sure(ActionMapping mapping, ActionForm form,
      HttpServletRequest request, HttpServletResponse response) {
    ActionMessages message=null;
    EvaluateAF AF = (EvaluateAF) form;
    SecurityInfo securityInfo = (SecurityInfo) request.getSession()
    .getAttribute("SecurityInfo");
    String error="操作失败!";
    EvaluateAFDTO evaluateAFDTO = null ;
    
    try{
      IEvaluateBS evaluateBS=(IEvaluateBS)BSUtils
      .getBusinessService("evaluateBS", this, mapping.getModuleConfig());
      if(AF.getType().equals("添加"))
      {
        //张列改 头
        evaluateAFDTO = new EvaluateAFDTO();
        BeanUtils.copyProperties(evaluateAFDTO, AF);
        evaluateBS.insertEvaluateList(evaluateAFDTO,securityInfo);
        //张列改 尾
        
        error="添加成功!";
        return mapping.findForward("evaluateShowAC"); //添加成功
      }
      if(AF.getType().equals("修改"))
      { 
        //张列改 头
        evaluateAFDTO = new EvaluateAFDTO();
        BeanUtils.copyProperties(evaluateAFDTO, AF);
        evaluateBS.updateEvaluate(evaluateAFDTO,securityInfo);
        //张列改  尾
        
        error="修改成功!";
        return mapping.findForward("evaluateShowAC");
      }
    }
    catch(Exception e)
    {
      error="操作失败";
      e.printStackTrace();  
    }finally{
      message= new ActionMessages();
      message.add(ActionMessages.GLOBAL_MESSAGE, new ActionMessage(error,false));
      saveErrors(request,message);
    }
    return mapping.findForward("evaluateShowAC"); //添加成功
  }
  public ActionForward scan(ActionMapping mapping, ActionForm form,      
      HttpServletRequest request, HttpServletResponse response) {
    return mapping.findForward("evaluateShowAC");
  }
  public ActionForward back(ActionMapping mapping, ActionForm form,
      HttpServletRequest request, HttpServletResponse response) {
    return mapping.findForward("evaluateShowAC");
  }
}