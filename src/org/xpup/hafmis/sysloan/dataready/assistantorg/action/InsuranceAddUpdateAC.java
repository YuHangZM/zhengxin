/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package org.xpup.hafmis.sysloan.dataready.assistantorg.action;

import java.util.HashMap;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.beanutils.BeanUtils;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.action.ActionMessage;
import org.apache.struts.action.ActionMessages;
import org.apache.struts.actions.LookupDispatchAction;
import org.xpup.common.util.BSUtils;
import org.xpup.hafmis.orgstrct.dto.SecurityInfo;
import org.xpup.hafmis.sysloan.dataready.assistantorg.bsinterface.IInsuranceBS;
import org.xpup.hafmis.sysloan.dataready.assistantorg.dto.InsuranceAFDTO;
import org.xpup.hafmis.sysloan.dataready.assistantorg.form.InsuranceAF;

/** 
 * MyEclipse Struts
 * Creation date: 09-28-2007
 * 
 * XDoclet definition:
 * @struts.action validate="true"
 */
public class InsuranceAddUpdateAC extends LookupDispatchAction {
  public static final String PAGINATION_KEY =
    "org.xpup.hafmis.sysloan.dataready.assistantorg.action.InsuranceShowAC";
  protected Map getKeyMethodMap() {
    Map map = new HashMap();
    map.put("button.sure", "sure");
    map.put("button.scan", "scan");
    map.put("button.back", "back");
    return map;
  }
  /** 
   * Method execute
   * @param mapping
   * @param form
   * @param request
   * @param response
   * @return ActionForward
   */
  public ActionForward sure(ActionMapping mapping, ActionForm form,
      HttpServletRequest request, HttpServletResponse response) {
    ActionMessages message=null;
    InsuranceAF AF = (InsuranceAF) form;
    SecurityInfo securityInfo = (SecurityInfo) request.getSession()
    .getAttribute("SecurityInfo");
    String error="操作失败!";
    
    InsuranceAFDTO insuranceAFDTO = null;
    
    try{
      IInsuranceBS insuranceBS=(IInsuranceBS)BSUtils
      .getBusinessService("insuranceBS", this, mapping.getModuleConfig());
      if(AF.getType().equals("添加"))
      {
        //张列改 头
        insuranceAFDTO = new InsuranceAFDTO();
        BeanUtils.copyProperties(insuranceAFDTO, AF);
        insuranceBS.insertInsuranceList(insuranceAFDTO,securityInfo);
        //张列改 尾
        
        error="添加成功!";
        return mapping.findForward("insuranceShowAC"); //添加成功
      }
      if(AF.getType().equals("修改"))
      {  
        //张列改 头
        insuranceAFDTO = new InsuranceAFDTO();
        BeanUtils.copyProperties(insuranceAFDTO, AF);
        insuranceBS.updateInsurance(insuranceAFDTO,securityInfo);
        //张列改 尾
        
        error="修改成功!";
        return mapping.findForward("insuranceShowAC");
      }
    }
    catch(Exception e)
    {
      error="操作失败";
      e.printStackTrace();  
    }finally{
      message= new ActionMessages();
      message.add(ActionMessages.GLOBAL_MESSAGE, new ActionMessage(error,false));
      saveErrors(request,message);
    }
    return mapping.findForward("insuranceShowAC"); //添加成功
  }
  
  public ActionForward scan(ActionMapping mapping, ActionForm form,      
      HttpServletRequest request, HttpServletResponse response) {
//    ActionMessages message=null;

    return mapping.findForward("insuranceShowAC"); //添加成功
  }
  public ActionForward back(ActionMapping mapping, ActionForm form,
      HttpServletRequest request, HttpServletResponse response) {
    return mapping.findForward("insuranceShowAC");
  }
}